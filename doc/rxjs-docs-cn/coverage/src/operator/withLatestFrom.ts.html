<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/operator/withLatestFrom.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">All files</a> / <a href="index.html">src/operator</a> withLatestFrom.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">95.92% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>47/49</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>10/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>10/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">95.65% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>44/46</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">34x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">5x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">29x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">29x</span>
<span class="cline-any cline-yes">29x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">62x</span>
<span class="cline-any cline-yes">62x</span>
<span class="cline-any cline-yes">62x</span>
<span class="cline-any cline-yes">31x</span>
<span class="cline-any cline-yes">31x</span>
<span class="cline-any cline-yes">23x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">26x</span>
<span class="cline-any cline-yes">19x</span>
<span class="cline-any cline-yes">19x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import { Operator } from '../Operator';
import { Subscriber } from '../Subscriber';
import { Observable, ObservableInput } from '../Observable';
import { OuterSubscriber } from '../OuterSubscriber';
import { InnerSubscriber } from '../InnerSubscriber';
import { subscribeToResult } from '../util/subscribeToResult';
&nbsp;
/**
 * Combines the source Observable with other Observables to create an Observable
 * whose values are calculated from the latest values of each, only when the
 * source emits.
 *
 * &lt;span class="informal"&gt;Whenever the source Observable emits a value, it
 * computes a formula using that value plus the latest values from other input
 * Observables, then emits the output of that formula.&lt;/span&gt;
 *
 * &lt;img src="./img/withLatestFrom.png" width="100%"&gt;
 *
 * `withLatestFrom` combines each value from the source Observable (the
 * instance) with the latest values from the other input Observables only when
 * the source emits a value, optionally using a `project` function to determine
 * the value to be emitted on the output Observable. All input Observables must
 * emit at least one value before the output Observable will emit a value.
 *
 * @example &lt;caption&gt;On every click event, emit an array with the latest timer event plus the click event&lt;/caption&gt;
 * var clicks = Rx.Observable.fromEvent(document, 'click');
 * var timer = Rx.Observable.interval(1000);
 * var result = clicks.withLatestFrom(timer);
 * result.subscribe(x =&gt; console.log(x));
 *
 * @see {@link combineLatest}
 *
 * @param {Observable} other An input Observable to combine with the source
 * Observable. More than one input Observables may be given as argument.
 * @param {Function} [project] Projection function for combining values
 * together. Receives all values in order of the Observables passed, where the
 * first parameter is a value from the source Observable. (e.g.
 * `a.withLatestFrom(b, c, (a1, b1, c1) =&gt; a1 + b1 + c1)`). If this is not
 * passed, arrays will be emitted on the output Observable.
 * @return {Observable} An Observable of projected values from the most recent
 * values from each input Observable, or an array of the most recent values from
 * each input Observable.
 * @method withLatestFrom
 * @owner Observable
 */
/* tslint:disable:max-line-length */
export function withLatestFrom&lt;T, R&gt;(this: Observable&lt;T&gt;, project: (v1: T) =&gt; R): Observable&lt;R&gt;;
export function withLatestFrom&lt;T, T2, R&gt;(this: Observable&lt;T&gt;, v2: ObservableInput&lt;T2&gt;, project: (v1: T, v2: T2) =&gt; R): Observable&lt;R&gt;;
export function withLatestFrom&lt;T, T2, T3, R&gt;(this: Observable&lt;T&gt;, v2: ObservableInput&lt;T2&gt;, v3: ObservableInput&lt;T3&gt;, project: (v1: T, v2: T2, v3: T3) =&gt; R): Observable&lt;R&gt;;
export function withLatestFrom&lt;T, T2, T3, T4, R&gt;(this: Observable&lt;T&gt;, v2: ObservableInput&lt;T2&gt;, v3: ObservableInput&lt;T3&gt;, v4: ObservableInput&lt;T4&gt;, project: (v1: T, v2: T2, v3: T3, v4: T4) =&gt; R): Observable&lt;R&gt;;
export function withLatestFrom&lt;T, T2, T3, T4, T5, R&gt;(this: Observable&lt;T&gt;, v2: ObservableInput&lt;T2&gt;, v3: ObservableInput&lt;T3&gt;, v4: ObservableInput&lt;T4&gt;, v5: ObservableInput&lt;T5&gt;, project: (v1: T, v2: T2, v3: T3, v4: T4, v5: T5) =&gt; R): Observable&lt;R&gt;;
export function withLatestFrom&lt;T, T2, T3, T4, T5, T6, R&gt;(this: Observable&lt;T&gt;, v2: ObservableInput&lt;T2&gt;, v3: ObservableInput&lt;T3&gt;, v4: ObservableInput&lt;T4&gt;, v5: ObservableInput&lt;T5&gt;, v6: ObservableInput&lt;T6&gt;, project: (v1: T, v2: T2, v3: T3, v4: T4, v5: T5, v6: T6) =&gt; R): Observable&lt;R&gt; ;
export function withLatestFrom&lt;T, T2&gt;(this: Observable&lt;T&gt;, v2: ObservableInput&lt;T2&gt;): Observable&lt;[T, T2]&gt;;
export function withLatestFrom&lt;T, T2, T3&gt;(this: Observable&lt;T&gt;, v2: ObservableInput&lt;T2&gt;, v3: ObservableInput&lt;T3&gt;): Observable&lt;[T, T2, T3]&gt;;
export function withLatestFrom&lt;T, T2, T3, T4&gt;(this: Observable&lt;T&gt;, v2: ObservableInput&lt;T2&gt;, v3: ObservableInput&lt;T3&gt;, v4: ObservableInput&lt;T4&gt;): Observable&lt;[T, T2, T3, T4]&gt;;
export function withLatestFrom&lt;T, T2, T3, T4, T5&gt;(this: Observable&lt;T&gt;, v2: ObservableInput&lt;T2&gt;, v3: ObservableInput&lt;T3&gt;, v4: ObservableInput&lt;T4&gt;, v5: ObservableInput&lt;T5&gt;): Observable&lt;[T, T2, T3, T4, T5]&gt;;
export function withLatestFrom&lt;T, T2, T3, T4, T5, T6&gt;(this: Observable&lt;T&gt;, v2: ObservableInput&lt;T2&gt;, v3: ObservableInput&lt;T3&gt;, v4: ObservableInput&lt;T4&gt;, v5: ObservableInput&lt;T5&gt;, v6: ObservableInput&lt;T6&gt;): Observable&lt;[T, T2, T3, T4, T5, T6]&gt; ;
export function withLatestFrom&lt;T, R&gt;(this: Observable&lt;T&gt;, ...observables: Array&lt;ObservableInput&lt;any&gt; | ((...values: Array&lt;any&gt;) =&gt; R)&gt;): Observable&lt;R&gt;;
export function withLatestFrom&lt;T, R&gt;(this: Observable&lt;T&gt;, array: ObservableInput&lt;any&gt;[]): Observable&lt;R&gt;;
export function withLatestFrom&lt;T, R&gt;(this: Observable&lt;T&gt;, array: ObservableInput&lt;any&gt;[], project: (...values: Array&lt;any&gt;) =&gt; R): Observable&lt;R&gt;;
/* tslint:disable:max-line-length */
export function withLatestFrom&lt;T, R&gt;(this: Observable&lt;T&gt;, ...args: Array&lt;ObservableInput&lt;any&gt; | ((...values: Array&lt;any&gt;) =&gt; R)&gt;): Observable&lt;R&gt; {
  let project: any;
  if (typeof args[args.length - 1] === 'function') {
    project = args.pop();
  }
  const observables = &lt;Observable&lt;any&gt;[]&gt;args;
  return this.lift(new WithLatestFromOperator(observables, project));
}
&nbsp;
class WithLatestFromOperator&lt;T, R&gt; implements Operator&lt;T, R&gt; {
  constructor(private observables: Observable&lt;any&gt;[],
              private project?: (...values: any[]) =&gt; Observable&lt;R&gt;) {
  }
&nbsp;
  call(subscriber: Subscriber&lt;R&gt;, source: any): any {
    return source._subscribe(new WithLatestFromSubscriber(subscriber, this.observables, this.project));
  }
}
&nbsp;
/**
 * We need this JSDoc comment for affecting ESDoc.
 * @ignore
 * @extends {Ignored}
 */
class WithLatestFromSubscriber&lt;T, R&gt; extends OuterSubscriber&lt;T, R&gt; {
  private values: any[];
  private toRespond: number[] = [];
&nbsp;
  constructor(destination: Subscriber&lt;R&gt;,
              private observables: Observable&lt;any&gt;[],
              private project?: (...values: any[]) =&gt; Observable&lt;R&gt;) {
    super(destination);
    const len = observables.length;
    this.values = new Array(len);
&nbsp;
    for (let i = 0; i &lt; len; i++) {
      this.toRespond.push(i);
    }
&nbsp;
    for (let i = 0; i &lt; len; i++) {
      let observable = observables[i];
      this.add(subscribeToResult&lt;T, R&gt;(this, observable, &lt;any&gt;observable, i));
    }
  }
&nbsp;
  notifyNext(outerValue: T, innerValue: R,
             outerIndex: number, innerIndex: number,
             innerSub: InnerSubscriber&lt;T, R&gt;): void {
    this.values[outerIndex] = innerValue;
    const toRespond = this.toRespond;
    if (toRespond.length &gt; 0) {
      const found = toRespond.indexOf(outerIndex);
      if (found !== -1) {
        toRespond.splice(found, 1);
      }
    }
  }
&nbsp;
  notifyComplete() {
    // noop
  }
&nbsp;
  protected _next(value: T) {
    if (this.toRespond.length === 0) {
      const args = [value, ...this.values];
      if (this.project) {
        this._tryProject(args);
      } else {
        this.destination.next(args);
      }
    }
  }
&nbsp;
  private _tryProject(args: any[]) {
    let result: any;
    try {
      result = this.project.apply(this, args);
    } catch (err) {
<span class="cstat-no" title="statement not covered" >      this.destination.error(err);</span>
<span class="cstat-no" title="statement not covered" >      return;</span>
    }
    this.destination.next(result);
  }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Fri Nov 04 2016 10:11:12 GMT-0700 (PDT)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
